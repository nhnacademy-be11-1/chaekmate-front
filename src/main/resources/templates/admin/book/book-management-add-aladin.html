<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko"
      th:replace="~{admin/layout/admin-layout :: html(~{::section})}">
<section>
    <div class="container-fluid">
        <div class="row px-xl-5">
            <div class="col-12">
                <h2 class="h2 font-weight-bold text-dark mb-4">알라딘으로 도서 추가</h2>

                <!-- Search Form -->
                <form class="form-inline mb-4" th:action="@{/admin/books/add-aladin}" method="get">
                    <div class="form-group mr-2">
                        <select class="form-control" name="searchType">
                            <option value="Title" th:selected="${searchType == 'Title'}">제목</option>
                            <option value="Author" th:selected="${searchType == 'Author'}">저자</option>
                            <option value="Publisher" th:selected="${searchType == 'Publisher'}">출판사</option>
                        </select>
                    </div>
                    <input class="form-control mr-sm-2 w-50" type="search" name="query" placeholder="검색어를 입력하세요" th:value="${query}" required>
                    <button class="btn btn-outline-success my-2 my-sm-0" type="submit">검색</button>
                </form>

                <!-- Search Result -->
                <div th:if="${searchResult}">
                    <h4 class="h4 font-weight-bold text-dark mb-3">검색 결과</h4>
                    <div th:if="${searchResult.empty}" class="alert alert-warning">검색 결과가 없습니다.</div>

                    <table class="table table-bordered text-center" th:unless="${searchResult.empty}">
                        <thead class="thead-dark">
                        <tr>
                            <th style="width: 10%;">표지</th>
                            <th style="width: 30%;">제목</th>
                            <th style="width: 20%;">저자/출판사</th>
                            <th style="width: 15%;">출판일</th>
                            <th style="width: 15%;">ISBN</th>
                            <th style="width: 10%;">관리</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="book : ${searchResult.content}">
                            <td><img th:src="${book.coverImage}" alt="cover" style="max-width: 100px;"></td>
                            <td class="text-left" th:text="${book.title}"></td>
                            <td th:text="${book.author} + ' / ' + ${book.publisher}"></td>
                            <td th:text="${book.publishedAt}"></td>
                            <td th:text="${book.isbn}"></td>
                            <td>
                                <a class="btn btn-sm btn-primary" th:href="@{/admin/books/add-direct(title=${book.title}, author=${book.author}, isbn=${book.isbn}, publishedDate=${book.publishedAt}, description=${book.description}, price=${book.price}, salesPrice=${book.salesPrice}, thumbnailUrl=${book.coverImage})}">이 책으로<br>등록</a>
                            </td>
                        </tr>
                        </tbody>
                    </table>

                    <!-- Pagination -->
                    <nav aria-label="Page navigation" th:if="${!searchResult.empty}">
                        <ul class="pagination justify-content-center">
                            <li class="page-item" th:classappend="${searchResult.first} ? 'disabled' : ''">
                                <a class="page-link" th:href="@{/admin/books/add-aladin(query=${query}, searchType=${searchType}, page=${searchResult.number - 1})}">Previous</a>
                            </li>
                            <li class="page-item" th:each="i : ${#numbers.sequence(0, searchResult.totalPages - 1)}" th:classappend="${i == searchResult.number} ? 'active' : ''">
                                <a class="page-link" th:href="@{/admin/books/add-aladin(query=${query}, searchType=${searchType}, page=${i})}" th:text="${i + 1}"></a>
                            </li>
                            <li class="page-item" th:classappend="${searchResult.last} ? 'disabled' : ''">
                                <a class="page-link" th:href="@{/admin/books/add-aladin(query=${query}, searchType=${searchType}, page=${searchResult.number + 1})}">Next</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</section>
</html>
