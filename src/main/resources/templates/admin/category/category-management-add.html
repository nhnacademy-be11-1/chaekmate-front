<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko"
      th:replace="~{layout/layout :: html(~{::section})}">
<section>
    <div class="container-fluid">
        <div class="row px-xl-5">
            <div class="col-12">
                <h2 class="h2 font-weight-bold text-dark mb-4">새 카테고리 추가</h2>
                <form th:action="@{/admin/categories}" method="post">
                    <div class="form-group">
                        <label for="categoryName">카테고리 이름</label>
                        <input type="text" class="form-control" id="categoryName" name="name" placeholder="카테고리 이름을 입력하세요" required>
                    </div>
                    <div class="form-group">
                        <label for="parentCategory">상위 카테고리 설정</label>
                        <select class="form-control" id="parentCategory" name="parentId">
                            <option value="">-- 없음 (최상위 카테고리) --</option>

                            <!-- 상위 카테고리 -->
                            <option th:each="category : ${categories}"
                                    th:value="${category.id}"
                                    th:text="${category.name}"
                                    th:if="${category.children.isEmpty()}">
                            </option>

                            <!-- 자식 카테고리가 있는 경우 optgroup 사용 -->
                            <optgroup th:each="category : ${categories}"
                                      th:if="${!category.children.isEmpty()}"
                                      th:label="${category.name}">
                                <option th:each="child : ${category.children}"
                                        th:value="${child.id}"
                                        th:text="${child.name}">
                                </option>
                            </optgroup>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">추가하기</button>
                </form>
            </div>
        </div>
    </div>
</section>
</html>
